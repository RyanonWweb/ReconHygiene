---
import SiteLayout from '../../layouts/SiteLayout.astro';
import PostCard from '../../components/PostCard.astro';
import { getCollection } from 'astro:content';

const guides = (await getCollection('guides', ({ data }) => !data.draft))
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());

const categories = [...new Set(guides.map(g => g.data.category))];
---

<SiteLayout title="Security Guides" description="Practical, short-form security guides and checklists for practitioners. Actionable over theoretical.">
  <div class="page-header">
    <div class="container">
      <div class="breadcrumb"><a href="/">Home</a> / Guides</div>
      <h1 class="page-title">Security Guides</h1>
      <p class="page-sub">Short, actionable security guides â€” checklists, how-tos, and reference material built for practitioners doing the work.</p>
      <div class="page-meta-strip">
        <span class="badge badge-cyan">{guides.length} Guides</span>
        {categories.map(c => <span class="tag">{c}</span>)}
      </div>
    </div>
  </div>
  <section class="section">
    <div class="container">
      {guides.length === 0 ? (
        <div class="empty-state glass">
          <div class="empty-icon">ðŸ“‹</div>
          <h3>Guides coming soon</h3>
          <p>Content is in progress. First guide drops shortly.</p>
        </div>
      ) : (
        <div class="content-grid stagger-children">
          {guides.map(g => (
            <PostCard
              title={g.data.title}
              href={`/guides/${g.id.replace(/\.mdx?$/, '')}`}
              date={g.data.date}
              summary={g.data.summary}
              category={g.data.category}
              tags={g.data.tags}
            />
          ))}
        </div>
      )}
    </div>
  </section>
</SiteLayout>

<style>
  .page-header { border-bottom: 1px solid var(--border); background: var(--surface); padding: 4rem 0 2.5rem; }
  .breadcrumb { font-size: 0.8rem; color: var(--text-muted); margin-bottom: 0.75rem; font-family: 'JetBrains Mono', monospace; }
  .breadcrumb a { color: var(--text-muted); }
  .breadcrumb a:hover { color: var(--cyan); }
  .page-title { font-size: 2.25rem; font-weight: 700; margin: 0 0 0.75rem; }
  .page-sub { color: var(--text-muted); font-size: 0.95rem; max-width: 65ch; line-height: 1.7; margin: 0 0 1.25rem; }
  .page-meta-strip { display: flex; flex-wrap: wrap; align-items: center; gap: 0.5rem; }
  .empty-state { text-align: center; padding: 4rem 2rem; color: var(--text-muted); }
  .empty-icon { font-size: 2.5rem; margin-bottom: 1rem; }
  .empty-state h3 { color: var(--text); margin-bottom: 0.5rem; }
</style>
